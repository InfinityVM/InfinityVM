#!/bin/bash

RPC_URL=${RPC_URL:-http://localhost:8545}
CHAIN_ID=${CHAIN_ID:-31337}
PRIVATE_KEY=${PRIVATE_KEY:-0c7ec7aefb80022c0025be1e72dadb0679aa294cb1db453b2e7b5da8616b4e31}
# ABI-encoded request + result + signatures can be generated using rust/crates/scripts/signer.rs
# (these need to be re-generated every time the consumer address changes)
RESULT_WITH_METADATA=${1:-"290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e56300000000000000000000000000000000000000000000000000000000000f4240000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000970726f6772616d4944000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a"}
SIGNATURE_ON_RESULT=${2:-"b3e4536ee1991fec6a009a0df362b8b55a9f2b304d4d94f34a71e81203be3274679ec32fe27c3c7340664bd5c8c7855c8957c371e445b80fe693f381688894fb1c"}
JOB_REQUEST=${3:-"000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000f4240000000000000000000000000cf7ed3acca5a467e9e704c703e8d87f634fb0fc900000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000000970726f6772616d4944000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000"}
SIGNATURE_ON_REQUEST=${4:-"b3eaa3283db39bf2de4f91037a7c2544101ad59d8e935c90ab2ae18b09d3988734b3a3bddb24ce0bb52b15e852fbadff36d69dc1e950c3516dee4bf76022a33e1b"}

# cd to the directory of this script so that this can be run from anywhere
parent_path=$( cd "$(dirname "${BASH_SOURCE[0]}")" ; pwd -P )
cd "$parent_path"

forge script ../SubmitResultForOffchainJob.s.sol:SubmitResultForOffchainJob --sig "submitResultForOffchainJob(bytes calldata resultWithMetadata, bytes calldata signatureOnResult, bytes calldata jobRequest, bytes calldata signatureOnRequest)" $RESULT_WITH_METADATA $SIGNATURE_ON_RESULT $JOB_REQUEST $SIGNATURE_ON_REQUEST --rpc-url $RPC_URL --private-key $PRIVATE_KEY --chain-id $CHAIN_ID --broadcast -v
