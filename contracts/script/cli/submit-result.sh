#!/bin/bash

RPC_URL=${RPC_URL:-http://localhost:8545}
CHAIN_ID=${CHAIN_ID:-31337}
PRIVATE_KEY=${PRIVATE_KEY:-0c7ec7aefb80022c0025be1e72dadb0679aa294cb1db453b2e7b5da8616b4e31}
# ABI-encoded result + signature can be generated using crates/scripts/signer.rs
# (these need to be re-generated every time the consumer address changes)
RESULT_WITH_METADATA=${1:-"9a100e62829cbc6e07b8fc55253407eebd411b342b7781ac585b2688a9e359c4fc7fea3498733d20c11a0cf2984b78f88b954525730657cd0283d747479b3d6a00000000000000000000000000000000000000000000000000000000000f424000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000000970726f6772616d494400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000a5889624184923c0c4cfc3499cbea659e34f7809000000000000000000000000000000000000000000000000000000000000000a"}
SIGNATURE=${2:-"e8f5d7a1e8b4363e950879075d7a7e77d4b1b3e0f4f1c898371c057677500d476d1b50bc4f99334162358fb1ff5a3897f9d84ee35417e78afe748792d681ab1c1c"}

# cd to the directory of this script so that this can be run from anywhere
parent_path=$( cd "$(dirname "${BASH_SOURCE[0]}")" ; pwd -P )
cd "$parent_path"

forge script ../SubmitResult.s.sol:SubmitResult --sig "submitResult(bytes calldata resultWithMetadata, bytes calldata signature)" $RESULT_WITH_METADATA $SIGNATURE --rpc-url $RPC_URL --private-key $PRIVATE_KEY --chain-id $CHAIN_ID --broadcast -v
