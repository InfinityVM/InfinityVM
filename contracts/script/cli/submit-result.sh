#!/bin/bash

RPC_URL=${RPC_URL:-http://localhost:8545}
CHAIN_ID=${CHAIN_ID:-31337}
PRIVATE_KEY=${PRIVATE_KEY:-0c7ec7aefb80022c0025be1e72dadb0679aa294cb1db453b2e7b5da8616b4e31}
# ABI-encoded result + signature can be generated using crates/scripts/signer.rs
RESULT_WITH_METADATA=${1:-"0000000000000000000000000000000000000000000000000000000000000001fc7fea3498733d20c11a0cf2984b78f88b954525730657cd0283d747479b3d6a00000000000000000000000000000000000000000000000000000000000f424000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000000970726f6772616d494400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000a5889624184923c0c4cfc3499cbea659e34f7809000000000000000000000000000000000000000000000000000000000000000a"}
SIGNATURE=${2:-"1b773be023e31ededf7e5b9c1318d7662af71473b308b4bdd72b0d6e474316f83c66bc61e92ed3584ed160f89b0b2f69eb2fade3bc32e3588528e063d8d43b231c"}

# cd to the directory of this script so that this can be run from anywhere
parent_path=$( cd "$(dirname "${BASH_SOURCE[0]}")" ; pwd -P )
cd "$parent_path"

forge script ../SubmitResult.s.sol:SubmitResult --sig "submitResult(bytes calldata resultWithMetadata, bytes calldata signature)" $RESULT_WITH_METADATA $SIGNATURE --rpc-url $RPC_URL --private-key $PRIVATE_KEY --chain-id $CHAIN_ID --broadcast -v
